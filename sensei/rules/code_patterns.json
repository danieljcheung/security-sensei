{
  "patterns": {
    "python": [
      {
        "id": "sql-injection-fstring",
        "name": "SQL Injection (f-string)",
        "pattern": "f[\"']\\s*(?:SELECT|INSERT|UPDATE|DELETE|DROP|UNION|ALTER|CREATE|TRUNCATE)\\s+.*\\{",
        "flags": "IGNORECASE",
        "cwe": "CWE-89",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "SQL query constructed using f-string interpolation. User input in the query can lead to SQL injection attacks.",
        "fix": "Use parameterized queries with placeholders. For example: cursor.execute('SELECT * FROM users WHERE id = ?', (user_id,))"
      },
      {
        "id": "sql-injection-format",
        "name": "SQL Injection (.format())",
        "pattern": "[\"']\\s*(?:SELECT|INSERT|UPDATE|DELETE|DROP|UNION|ALTER|CREATE|TRUNCATE)\\s+.*[\"']\\.format\\s*\\(",
        "flags": "IGNORECASE",
        "cwe": "CWE-89",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "SQL query constructed using .format() string interpolation. This is vulnerable to SQL injection.",
        "fix": "Use parameterized queries instead of string formatting."
      },
      {
        "id": "sql-injection-concat",
        "name": "SQL Injection (concatenation)",
        "pattern": "[\"']\\s*(?:SELECT|INSERT|UPDATE|DELETE|DROP)\\s+.*[\"']\\s*\\+",
        "flags": "IGNORECASE",
        "cwe": "CWE-89",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "SQL query constructed using string concatenation. This pattern is vulnerable to SQL injection.",
        "fix": "Use parameterized queries with placeholders instead of concatenation."
      },
      {
        "id": "sql-injection-percent",
        "name": "SQL Injection (% formatting)",
        "pattern": "[\"']\\s*(?:SELECT|INSERT|UPDATE|DELETE|DROP)\\s+.*%s.*[\"']\\s*%",
        "flags": "IGNORECASE",
        "cwe": "CWE-89",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "SQL query constructed using % string formatting. This is vulnerable to SQL injection.",
        "fix": "Use parameterized queries with proper placeholders."
      },
      {
        "id": "command-injection-os-system",
        "name": "Command Injection (os.system)",
        "pattern": "os\\.system\\s*\\([^)]*(?:\\+|f[\"']|%|format\\(|\\{)",
        "flags": "",
        "cwe": "CWE-78",
        "owasp": "A03:2021",
        "severity": "CRITICAL",
        "confidence": "HIGH",
        "description": "os.system() called with dynamic input. This can lead to arbitrary command execution.",
        "fix": "Use subprocess.run() with a list of arguments (no shell=True) and validate/sanitize all inputs."
      },
      {
        "id": "command-injection-subprocess-shell",
        "name": "Command Injection (subprocess shell=True)",
        "pattern": "subprocess\\.(?:run|call|Popen|check_output|check_call)\\s*\\([^)]*shell\\s*=\\s*True",
        "flags": "",
        "cwe": "CWE-78",
        "owasp": "A03:2021",
        "severity": "CRITICAL",
        "confidence": "MEDIUM",
        "description": "subprocess called with shell=True. Combined with user input, this enables command injection.",
        "fix": "Use subprocess with shell=False and pass arguments as a list: subprocess.run(['cmd', 'arg1', 'arg2'])"
      },
      {
        "id": "command-injection-os-popen",
        "name": "Command Injection (os.popen)",
        "pattern": "os\\.popen\\s*\\(",
        "flags": "",
        "cwe": "CWE-78",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "os.popen() is deprecated and vulnerable to command injection. It executes commands through the shell.",
        "fix": "Use subprocess.run() with shell=False and a list of arguments."
      },
      {
        "id": "path-traversal-open",
        "name": "Path Traversal (open with variable)",
        "pattern": "open\\s*\\([^)]*(?:\\+|f[\"']|%|format\\(|\\{)[^)]*\\)",
        "flags": "",
        "cwe": "CWE-22",
        "owasp": "A01:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "File opened with dynamic path. Without proper validation, this can lead to path traversal attacks.",
        "fix": "Validate and sanitize file paths. Use os.path.basename() or pathlib to prevent directory traversal."
      },
      {
        "id": "insecure-deserialization-pickle",
        "name": "Insecure Deserialization (pickle)",
        "pattern": "pickle\\.(?:loads?|Unpickler)\\s*\\(",
        "flags": "",
        "cwe": "CWE-502",
        "owasp": "A08:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "pickle deserialization can execute arbitrary code when loading untrusted data.",
        "fix": "Avoid pickle for untrusted data. Use JSON or other safe serialization formats instead."
      },
      {
        "id": "insecure-deserialization-yaml-unsafe",
        "name": "Insecure Deserialization (yaml.load without Loader)",
        "pattern": "yaml\\.load\\s*\\([^)]*\\)(?!.*Loader)",
        "flags": "",
        "cwe": "CWE-502",
        "owasp": "A08:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "yaml.load() without a Loader argument uses the unsafe FullLoader and can execute arbitrary code.",
        "fix": "Use yaml.safe_load() or specify Loader=yaml.SafeLoader explicitly."
      },
      {
        "id": "insecure-deserialization-marshal",
        "name": "Insecure Deserialization (marshal)",
        "pattern": "marshal\\.loads?\\s*\\(",
        "flags": "",
        "cwe": "CWE-502",
        "owasp": "A08:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "marshal module is not secure against malicious data and should not be used with untrusted input.",
        "fix": "Use JSON or other safe serialization formats for untrusted data."
      },
      {
        "id": "weak-crypto-md5",
        "name": "Weak Cryptography (MD5)",
        "pattern": "(?:hashlib\\.)?md5\\s*\\(",
        "flags": "IGNORECASE",
        "cwe": "CWE-327",
        "owasp": "A02:2021",
        "severity": "MEDIUM",
        "confidence": "MEDIUM",
        "description": "MD5 is cryptographically broken. It should not be used for security-sensitive operations.",
        "fix": "Use SHA-256 or SHA-3 for checksums. Use bcrypt, scrypt, or Argon2 for passwords."
      },
      {
        "id": "weak-crypto-sha1",
        "name": "Weak Cryptography (SHA1)",
        "pattern": "(?:hashlib\\.)?sha1\\s*\\(",
        "flags": "IGNORECASE",
        "cwe": "CWE-327",
        "owasp": "A02:2021",
        "severity": "MEDIUM",
        "confidence": "MEDIUM",
        "description": "SHA1 is cryptographically weak. It should not be used for security-sensitive operations.",
        "fix": "Use SHA-256 or SHA-3 for checksums. Use bcrypt, scrypt, or Argon2 for passwords."
      },
      {
        "id": "weak-crypto-des",
        "name": "Weak Cryptography (DES)",
        "pattern": "(?:DES|Crypto\\.Cipher\\.DES|Cryptodome\\.Cipher\\.DES)",
        "flags": "",
        "cwe": "CWE-327",
        "owasp": "A02:2021",
        "severity": "MEDIUM",
        "confidence": "HIGH",
        "description": "DES is an obsolete cipher with a 56-bit key that can be brute-forced.",
        "fix": "Use AES-256 or ChaCha20-Poly1305 for encryption."
      },
      {
        "id": "hardcoded-temp-file",
        "name": "Insecure Temporary File",
        "pattern": "open\\s*\\([\"']/tmp/[^\"']+[\"']",
        "flags": "",
        "cwe": "CWE-377",
        "owasp": "A01:2021",
        "severity": "MEDIUM",
        "confidence": "HIGH",
        "description": "Hardcoded path to /tmp directory. This can lead to race conditions and symlink attacks.",
        "fix": "Use tempfile.mkstemp() or tempfile.NamedTemporaryFile() for secure temporary files."
      },
      {
        "id": "assert-security",
        "name": "Assert Used for Security Check",
        "pattern": "assert\\s+.*(?:password|token|auth|admin|permission|role|secret)",
        "flags": "IGNORECASE",
        "cwe": "CWE-617",
        "owasp": "A07:2021",
        "severity": "MEDIUM",
        "confidence": "LOW",
        "description": "Assert statements are removed when Python runs with optimization (-O). Don't use asserts for security checks.",
        "fix": "Use explicit if statements with proper error handling instead of assert."
      },
      {
        "id": "exec-eval",
        "name": "Code Injection (exec/eval)",
        "pattern": "(?:exec|eval)\\s*\\([^)]*(?:\\+|f[\"']|%|format\\(|\\{|input|request|argv)",
        "flags": "",
        "cwe": "CWE-94",
        "owasp": "A03:2021",
        "severity": "CRITICAL",
        "confidence": "HIGH",
        "description": "exec() or eval() with dynamic input can execute arbitrary Python code.",
        "fix": "Avoid exec/eval with user input. Use ast.literal_eval() for safe literal evaluation if needed."
      },
      {
        "id": "ssrf-requests",
        "name": "Potential SSRF (requests)",
        "pattern": "requests\\.(?:get|post|put|delete|patch|head)\\s*\\([^)]*(?:\\+|f[\"']|%|format\\(|\\{)",
        "flags": "",
        "cwe": "CWE-918",
        "owasp": "A10:2021",
        "severity": "HIGH",
        "confidence": "LOW",
        "description": "HTTP request with dynamic URL. Without validation, this can lead to Server-Side Request Forgery.",
        "fix": "Validate URLs against an allowlist of permitted hosts. Block internal/private IP ranges."
      }
    ],
    "javascript": [
      {
        "id": "sql-injection-template",
        "name": "SQL Injection (template literal)",
        "pattern": "`\\s*(?:SELECT|INSERT|UPDATE|DELETE|DROP|UNION|ALTER|CREATE)\\s+.*\\$\\{",
        "flags": "IGNORECASE",
        "cwe": "CWE-89",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "SQL query built using template literals. Interpolated values can lead to SQL injection.",
        "fix": "Use parameterized queries: db.query('SELECT * FROM users WHERE id = $1', [userId])"
      },
      {
        "id": "sql-injection-concat-js",
        "name": "SQL Injection (concatenation)",
        "pattern": "[\"']\\s*(?:SELECT|INSERT|UPDATE|DELETE|DROP)\\s+.*[\"']\\s*\\+",
        "flags": "IGNORECASE",
        "cwe": "CWE-89",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "SQL query constructed with string concatenation. This is vulnerable to SQL injection.",
        "fix": "Use parameterized queries with placeholders."
      },
      {
        "id": "command-injection-exec",
        "name": "Command Injection (child_process.exec)",
        "pattern": "(?:child_process\\.)?exec(?:Sync)?\\s*\\([^)]*(?:\\+|`.*\\$\\{|\\$\\()",
        "flags": "",
        "cwe": "CWE-78",
        "owasp": "A03:2021",
        "severity": "CRITICAL",
        "confidence": "HIGH",
        "description": "child_process.exec() with dynamic input can execute arbitrary shell commands.",
        "fix": "Use child_process.execFile() or spawn() with an array of arguments instead."
      },
      {
        "id": "command-injection-exec-simple",
        "name": "Command Injection (exec with variable)",
        "pattern": "(?:child_process\\.)?exec(?:Sync)?\\s*\\(\\s*[a-zA-Z_][a-zA-Z0-9_]*",
        "flags": "",
        "cwe": "CWE-78",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "child_process.exec() called with a variable. If user-controlled, this enables command injection.",
        "fix": "Use child_process.execFile() or spawn() with an array of arguments."
      },
      {
        "id": "xss-innerhtml",
        "name": "XSS (innerHTML)",
        "pattern": "\\.innerHTML\\s*=",
        "flags": "",
        "cwe": "CWE-79",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "innerHTML assignment can execute scripts if the value contains user input.",
        "fix": "Use textContent for text, or sanitize HTML with DOMPurify before using innerHTML."
      },
      {
        "id": "xss-document-write",
        "name": "XSS (document.write)",
        "pattern": "document\\.write(?:ln)?\\s*\\(",
        "flags": "",
        "cwe": "CWE-79",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "document.write() with dynamic content can introduce XSS vulnerabilities.",
        "fix": "Use DOM manipulation methods like createElement() and appendChild() instead."
      },
      {
        "id": "xss-outerhtml",
        "name": "XSS (outerHTML)",
        "pattern": "\\.outerHTML\\s*=",
        "flags": "",
        "cwe": "CWE-79",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "outerHTML assignment can execute scripts if the value contains user input.",
        "fix": "Sanitize HTML with DOMPurify before using outerHTML."
      },
      {
        "id": "xss-dangerously-set-innerhtml",
        "name": "XSS (dangerouslySetInnerHTML)",
        "pattern": "dangerouslySetInnerHTML\\s*=",
        "flags": "",
        "cwe": "CWE-79",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "HIGH",
        "description": "React's dangerouslySetInnerHTML bypasses XSS protections. Ensure content is sanitized.",
        "fix": "Sanitize HTML with DOMPurify before using dangerouslySetInnerHTML, or avoid it entirely."
      },
      {
        "id": "path-traversal-fs",
        "name": "Path Traversal (fs operations)",
        "pattern": "(?:fs\\.)?(?:readFile|writeFile|readFileSync|writeFileSync|createReadStream|createWriteStream|unlink|rmdir|mkdir)(?:Sync)?\\s*\\([^)]*(?:\\+|`.*\\$\\{)",
        "flags": "",
        "cwe": "CWE-22",
        "owasp": "A01:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "File system operation with dynamic path. Without validation, this enables path traversal.",
        "fix": "Use path.basename() or path.resolve() with validation to prevent directory traversal."
      },
      {
        "id": "insecure-deserialization-eval",
        "name": "Code Injection (eval)",
        "pattern": "eval\\s*\\(",
        "flags": "",
        "cwe": "CWE-94",
        "owasp": "A03:2021",
        "severity": "CRITICAL",
        "confidence": "HIGH",
        "description": "eval() executes arbitrary JavaScript code. With user input, this is extremely dangerous.",
        "fix": "Never use eval() with user input. Use JSON.parse() for JSON data."
      },
      {
        "id": "insecure-deserialization-function",
        "name": "Code Injection (Function constructor)",
        "pattern": "new\\s+Function\\s*\\(",
        "flags": "",
        "cwe": "CWE-94",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "Function constructor is similar to eval() and can execute arbitrary code.",
        "fix": "Avoid Function constructor with dynamic input. Use safer alternatives."
      },
      {
        "id": "weak-crypto-md5-js",
        "name": "Weak Cryptography (MD5)",
        "pattern": "(?:crypto\\.)?createHash\\s*\\([\"']md5[\"']\\)",
        "flags": "IGNORECASE",
        "cwe": "CWE-327",
        "owasp": "A02:2021",
        "severity": "MEDIUM",
        "confidence": "HIGH",
        "description": "MD5 is cryptographically broken and should not be used for security purposes.",
        "fix": "Use SHA-256 or SHA-3 for checksums. Use bcrypt or Argon2 for passwords."
      },
      {
        "id": "weak-crypto-sha1-js",
        "name": "Weak Cryptography (SHA1)",
        "pattern": "(?:crypto\\.)?createHash\\s*\\([\"']sha1[\"']\\)",
        "flags": "IGNORECASE",
        "cwe": "CWE-327",
        "owasp": "A02:2021",
        "severity": "MEDIUM",
        "confidence": "HIGH",
        "description": "SHA1 is cryptographically weak and should not be used for security purposes.",
        "fix": "Use SHA-256 or SHA-3 for checksums. Use bcrypt or Argon2 for passwords."
      },
      {
        "id": "weak-random",
        "name": "Insecure Randomness (Math.random)",
        "pattern": "Math\\.random\\s*\\(\\)",
        "flags": "",
        "cwe": "CWE-330",
        "owasp": "A02:2021",
        "severity": "MEDIUM",
        "confidence": "LOW",
        "description": "Math.random() is not cryptographically secure. Don't use for tokens, passwords, or security.",
        "fix": "Use crypto.randomBytes() or crypto.getRandomValues() for security-sensitive random values."
      },
      {
        "id": "open-redirect",
        "name": "Open Redirect",
        "pattern": "(?:window\\.)?location(?:\\.href)?\\s*=\\s*[^\"'][a-zA-Z_]",
        "flags": "",
        "cwe": "CWE-601",
        "owasp": "A01:2021",
        "severity": "MEDIUM",
        "confidence": "LOW",
        "description": "Redirect to a user-controlled URL can lead to phishing attacks.",
        "fix": "Validate redirect URLs against an allowlist of permitted destinations."
      },
      {
        "id": "postmessage-origin",
        "name": "PostMessage without Origin Check",
        "pattern": "addEventListener\\s*\\([\"']message[\"']",
        "flags": "",
        "cwe": "CWE-346",
        "owasp": "A07:2021",
        "severity": "MEDIUM",
        "confidence": "LOW",
        "description": "Message event listener detected. Ensure origin is validated before processing messages.",
        "fix": "Always check event.origin against expected origins before processing the message."
      },
      {
        "id": "prototype-pollution",
        "name": "Potential Prototype Pollution",
        "pattern": "\\[\\s*[\"']__proto__[\"']\\s*\\]|\\[\\s*[\"']constructor[\"']\\s*\\]\\s*\\[\\s*[\"']prototype[\"']\\s*\\]",
        "flags": "",
        "cwe": "CWE-1321",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "HIGH",
        "description": "Direct access to __proto__ or constructor.prototype can indicate prototype pollution.",
        "fix": "Use Object.create(null) for dictionaries, or validate keys against a blocklist."
      }
    ],
    "typescript": [
      {
        "id": "sql-injection-template-ts",
        "name": "SQL Injection (template literal)",
        "pattern": "`\\s*(?:SELECT|INSERT|UPDATE|DELETE|DROP|UNION|ALTER|CREATE)\\s+.*\\$\\{",
        "flags": "IGNORECASE",
        "cwe": "CWE-89",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "SQL query built using template literals. Interpolated values can lead to SQL injection.",
        "fix": "Use parameterized queries: db.query('SELECT * FROM users WHERE id = $1', [userId])"
      },
      {
        "id": "xss-innerhtml-ts",
        "name": "XSS (innerHTML)",
        "pattern": "\\.innerHTML\\s*=",
        "flags": "",
        "cwe": "CWE-79",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "innerHTML assignment can execute scripts if the value contains user input.",
        "fix": "Use textContent for text, or sanitize HTML with DOMPurify before using innerHTML."
      },
      {
        "id": "xss-dangerously-set-innerhtml-ts",
        "name": "XSS (dangerouslySetInnerHTML)",
        "pattern": "dangerouslySetInnerHTML\\s*=",
        "flags": "",
        "cwe": "CWE-79",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "HIGH",
        "description": "React's dangerouslySetInnerHTML bypasses XSS protections. Ensure content is sanitized.",
        "fix": "Sanitize HTML with DOMPurify before using dangerouslySetInnerHTML."
      },
      {
        "id": "any-type-security",
        "name": "Unsafe 'any' Type in Security Context",
        "pattern": "(?:password|token|secret|credential|auth)\\s*:\\s*any",
        "flags": "IGNORECASE",
        "cwe": "CWE-704",
        "owasp": "A07:2021",
        "severity": "LOW",
        "confidence": "LOW",
        "description": "Using 'any' type for security-sensitive data bypasses TypeScript's type checking.",
        "fix": "Use specific types for security-sensitive data to catch errors at compile time."
      }
    ],
    "java": [
      {
        "id": "sql-injection-concat-java",
        "name": "SQL Injection (concatenation)",
        "pattern": "(?:executeQuery|executeUpdate|execute)\\s*\\([^)]*\\+",
        "flags": "",
        "cwe": "CWE-89",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "HIGH",
        "description": "SQL query built with string concatenation. This is vulnerable to SQL injection.",
        "fix": "Use PreparedStatement with parameterized queries."
      },
      {
        "id": "sql-injection-statement-java",
        "name": "SQL Injection (Statement vs PreparedStatement)",
        "pattern": "Statement\\s+\\w+\\s*=.*createStatement",
        "flags": "",
        "cwe": "CWE-89",
        "owasp": "A03:2021",
        "severity": "MEDIUM",
        "confidence": "LOW",
        "description": "Using Statement instead of PreparedStatement. This may indicate dynamic SQL construction.",
        "fix": "Use PreparedStatement for all database queries."
      },
      {
        "id": "command-injection-runtime",
        "name": "Command Injection (Runtime.exec)",
        "pattern": "Runtime\\.getRuntime\\(\\)\\.exec\\s*\\(",
        "flags": "",
        "cwe": "CWE-78",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "Runtime.exec() can execute arbitrary commands if input is not validated.",
        "fix": "Validate and sanitize all input. Use ProcessBuilder with a list of arguments."
      },
      {
        "id": "xxe-documentbuilder",
        "name": "XXE Injection (DocumentBuilder)",
        "pattern": "DocumentBuilderFactory\\.newInstance\\(\\)",
        "flags": "",
        "cwe": "CWE-611",
        "owasp": "A05:2021",
        "severity": "HIGH",
        "confidence": "LOW",
        "description": "XML parsing without disabling external entities can lead to XXE attacks.",
        "fix": "Disable external entities: factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)"
      },
      {
        "id": "weak-crypto-md5-java",
        "name": "Weak Cryptography (MD5)",
        "pattern": "MessageDigest\\.getInstance\\s*\\([\"']MD5[\"']\\)",
        "flags": "IGNORECASE",
        "cwe": "CWE-327",
        "owasp": "A02:2021",
        "severity": "MEDIUM",
        "confidence": "HIGH",
        "description": "MD5 is cryptographically broken and should not be used for security.",
        "fix": "Use SHA-256 or stronger algorithms."
      },
      {
        "id": "insecure-deserialization-java",
        "name": "Insecure Deserialization (ObjectInputStream)",
        "pattern": "new\\s+ObjectInputStream\\s*\\(",
        "flags": "",
        "cwe": "CWE-502",
        "owasp": "A08:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "ObjectInputStream deserialization of untrusted data can execute arbitrary code.",
        "fix": "Use allowlist-based filtering or avoid Java serialization with untrusted data."
      }
    ],
    "go": [
      {
        "id": "sql-injection-sprintf-go",
        "name": "SQL Injection (fmt.Sprintf)",
        "pattern": "(?:Query|Exec|QueryRow)\\s*\\(\\s*fmt\\.Sprintf",
        "flags": "",
        "cwe": "CWE-89",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "HIGH",
        "description": "SQL query built with fmt.Sprintf. This is vulnerable to SQL injection.",
        "fix": "Use parameterized queries: db.Query('SELECT * FROM users WHERE id = $1', id)"
      },
      {
        "id": "sql-injection-concat-go",
        "name": "SQL Injection (concatenation)",
        "pattern": "(?:Query|Exec|QueryRow)\\s*\\([^)]*\\+",
        "flags": "",
        "cwe": "CWE-89",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "SQL query built with string concatenation. This is vulnerable to SQL injection.",
        "fix": "Use parameterized queries with placeholders."
      },
      {
        "id": "command-injection-exec-go",
        "name": "Command Injection (exec.Command)",
        "pattern": "exec\\.Command\\s*\\([^,)]+\\+",
        "flags": "",
        "cwe": "CWE-78",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "exec.Command with dynamic input can lead to command injection.",
        "fix": "Validate and sanitize all input before passing to exec.Command."
      },
      {
        "id": "path-traversal-go",
        "name": "Path Traversal",
        "pattern": "(?:os\\.Open|ioutil\\.ReadFile|os\\.ReadFile)\\s*\\([^)]*\\+",
        "flags": "",
        "cwe": "CWE-22",
        "owasp": "A01:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "File operation with dynamic path can lead to path traversal.",
        "fix": "Use filepath.Clean() and validate paths stay within allowed directories."
      },
      {
        "id": "weak-crypto-md5-go",
        "name": "Weak Cryptography (MD5)",
        "pattern": "md5\\.(?:New|Sum)",
        "flags": "",
        "cwe": "CWE-327",
        "owasp": "A02:2021",
        "severity": "MEDIUM",
        "confidence": "HIGH",
        "description": "MD5 is cryptographically broken and should not be used for security.",
        "fix": "Use crypto/sha256 or stronger algorithms."
      }
    ],
    "php": [
      {
        "id": "sql-injection-php",
        "name": "SQL Injection",
        "pattern": "(?:mysql_query|mysqli_query|pg_query)\\s*\\([^)]*\\$",
        "flags": "",
        "cwe": "CWE-89",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "HIGH",
        "description": "SQL query with variable interpolation is vulnerable to SQL injection.",
        "fix": "Use PDO prepared statements or mysqli_prepare()."
      },
      {
        "id": "command-injection-php",
        "name": "Command Injection",
        "pattern": "(?:exec|system|passthru|shell_exec|popen|proc_open)\\s*\\([^)]*\\$",
        "flags": "",
        "cwe": "CWE-78",
        "owasp": "A03:2021",
        "severity": "CRITICAL",
        "confidence": "HIGH",
        "description": "Command execution with variable input enables command injection.",
        "fix": "Use escapeshellarg() and escapeshellcmd() to sanitize input, or avoid shell commands."
      },
      {
        "id": "xss-echo-php",
        "name": "XSS (echo without encoding)",
        "pattern": "echo\\s+\\$_(?:GET|POST|REQUEST|COOKIE)",
        "flags": "",
        "cwe": "CWE-79",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "HIGH",
        "description": "Outputting user input without encoding leads to XSS.",
        "fix": "Use htmlspecialchars() or htmlentities() to encode output."
      },
      {
        "id": "path-traversal-php",
        "name": "Path Traversal",
        "pattern": "(?:include|require|include_once|require_once|fopen|file_get_contents)\\s*\\([^)]*\\$",
        "flags": "",
        "cwe": "CWE-22",
        "owasp": "A01:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "File operation with user input can lead to path traversal or file inclusion.",
        "fix": "Validate and sanitize file paths. Use basename() and realpath() checks."
      },
      {
        "id": "insecure-deserialization-php",
        "name": "Insecure Deserialization",
        "pattern": "unserialize\\s*\\([^)]*\\$",
        "flags": "",
        "cwe": "CWE-502",
        "owasp": "A08:2021",
        "severity": "HIGH",
        "confidence": "HIGH",
        "description": "unserialize() with user input can lead to object injection attacks.",
        "fix": "Use JSON for data serialization, or validate serialized data strictly."
      }
    ],
    "ruby": [
      {
        "id": "sql-injection-ruby",
        "name": "SQL Injection",
        "pattern": "(?:find_by_sql|execute|select_all)\\s*\\([^)]*#\\{",
        "flags": "",
        "cwe": "CWE-89",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "HIGH",
        "description": "SQL query with string interpolation is vulnerable to SQL injection.",
        "fix": "Use parameterized queries or ActiveRecord's where() with placeholders."
      },
      {
        "id": "command-injection-ruby",
        "name": "Command Injection",
        "pattern": "(?:system|exec|`|%x\\[).*#\\{",
        "flags": "",
        "cwe": "CWE-78",
        "owasp": "A03:2021",
        "severity": "CRITICAL",
        "confidence": "HIGH",
        "description": "Command execution with interpolated input enables command injection.",
        "fix": "Use array form of system/exec, or Shellwords.escape() to sanitize."
      },
      {
        "id": "xss-ruby-raw",
        "name": "XSS (raw output)",
        "pattern": "<%=\\s*raw\\s+",
        "flags": "",
        "cwe": "CWE-79",
        "owasp": "A03:2021",
        "severity": "HIGH",
        "confidence": "HIGH",
        "description": "raw() bypasses Rails HTML escaping, enabling XSS if input is user-controlled.",
        "fix": "Use sanitize() helper or avoid raw() with user input."
      },
      {
        "id": "insecure-deserialization-ruby",
        "name": "Insecure Deserialization (Marshal/YAML)",
        "pattern": "(?:Marshal|YAML)\\.load\\s*\\(",
        "flags": "",
        "cwe": "CWE-502",
        "owasp": "A08:2021",
        "severity": "HIGH",
        "confidence": "MEDIUM",
        "description": "Marshal.load and YAML.load can execute arbitrary code with untrusted input.",
        "fix": "Use YAML.safe_load() or JSON for untrusted data."
      }
    ]
  },
  "language_extensions": {
    "python": [".py"],
    "javascript": [".js", ".mjs", ".cjs"],
    "typescript": [".ts", ".tsx"],
    "java": [".java"],
    "go": [".go"],
    "php": [".php"],
    "ruby": [".rb", ".erb"]
  }
}
